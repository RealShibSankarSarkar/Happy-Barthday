<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rimjhim's Surprise Birthday üéâ</title> 
  <!-- Title is now generic/surprise -->

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:hsl(30, 100%, 98%);
      --card:white;
      --accent:hsl(330,80%,65%);
      --accent2:hsl(280,80%,70%);
      --text:hsl(240,10%,18%);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Quicksand',sans-serif;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    .wrap{max-width:1100px;margin:20px auto;padding:20px}
    .card{background:var(--card);border-radius:18px;padding:22px;box-shadow:0 12px 30px rgba(0,0,0,0.06);border:1px solid rgba(0,0,0,0.04);margin-bottom:18px}
    .header{display:flex;align-items:center;gap:20px}
    .title{
      font-family:'Pacifico',cursive;
      font-size:3rem;
      margin:0;
      color:var(--accent);
      position:relative;
      padding-right:12px;
      animation:neon 3s infinite;
      text-shadow: 0 0 6px rgba(255,112,166,0.8);
    }
    @keyframes neon{
      0%{text-shadow:0 0 6px rgba(255,112,166,0.6)}
      50%{text-shadow:0 0 28px rgba(255,112,166,0.9)}
      100%{text-shadow:0 0 6px rgba(255,112,166,0.6)}
    }
    .subtitle{font-size:1.05rem;color:var(--text);margin:0 0 0 2px}
    /* layout */
    .top-row{display:flex;gap:20px;flex-wrap:wrap}
    .left{flex:0 1 360px}
    .right{flex:1 1 560px;min-width:280px}

    /* hero image & glow */
    .hero-wrap{text-align:center}
    .hero{
      width:240px;height:240px;border-radius:50%;object-fit:cover;border:6px solid var(--accent2);
      box-shadow:0 0 50px rgba(255,156,112,0.35), 0 0 18px rgba(255,255,255,0.7) inset;
      transition:transform .35s ease, box-shadow .35s ease;
      animation:pulse 4s infinite;
    }
    @keyframes pulse{
      0%{transform:scale(1)}
      50%{transform:scale(1.04)}
      100%{transform:scale(1)}
    }

    /* shayari box */
    .shayari{background:linear-gradient(180deg, #fff, #fff);padding:16px;border-radius:12px;margin-bottom:12px;line-height:1.7;border-left:6px solid var(--accent);box-shadow:0 8px 20px rgba(0,0,0,0.04)}

    /* form */
    label{display:block;margin-top:12px;font-weight:600}
    input,textarea,select{
      width:100%;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.12);margin-top:8px;font-size:1rem;background:rgba(255,255,255,0.95)
    }
    textarea{min-height:96px;resize:vertical}
    .row{display:flex;gap:12px}
    .row .col{flex:1}

    .send-btn{margin-top:14px;padding:12px 18px;border-radius:12px;border:none;background:linear-gradient(135deg,var(--accent),var(--accent2));color:white;font-weight:700;cursor:pointer;font-size:1rem;box-shadow:0 10px 24px rgba(255,112,166,0.12);transition:transform .18s}
    .send-btn:active{transform:translateY(2px)}

    /* wishes feed */
    .wishes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;margin-top:16px}
    .wish-card{background:linear-gradient(180deg,#fff,#fff);padding:14px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06);border:1px solid rgba(0,0,0,0.04)}
    .wish-meta{font-size:12px;color:gray;margin-bottom:8px}
    .wish-photo{width:100%;max-height:160px;object-fit:cover;border-radius:8px;margin-top:8px;border:1px solid rgba(0,0,0,0.05)}

    /* floating hearts */
    .hearts{position:fixed;left:0;right:0;top:0;bottom:0;pointer-events:none;overflow:hidden;z-index:5}
    .heart{position:absolute;width:18px;height:18px;background:linear-gradient(45deg,#ff8ab8,#ffd47a);transform:rotate(45deg);border-radius:3px;opacity:0.9}
    .heart:before,.heart:after{content:"";position:absolute;background:inherit;border-radius:50%}
    .heart:before{width:18px;height:18px;top:-9px;left:0}
    .heart:after{width:18px;height:18px;left:-9px;top:0}

    /* confetti canvas on top layer */
    #confetti{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:6}

    /* music/unmute button */
    .music-control{position:fixed;right:18px;bottom:18px;z-index:9;background:white;padding:10px;border-radius:999px;box-shadow:0 10px 30px rgba(0,0,0,0.12);display:flex;gap:8px;align-items:center}

    @media(max-width:720px){
      .title{font-size:2rem}
      .top-row{flex-direction:column}
      .left,.right{flex:1 1 auto}
      .hero{width:200px;height:200px}
    }
  </style>
</head>
<body>

<!-- floating hearts container -->
<div class="hearts" id="hearts"></div>

<!-- confetti canvas -->
<canvas id="confetti"></canvas>

<div class="wrap">

  <!-- DYNAMIC HEADER: Text changes from "Surprise Loading..." to "Happy Birthday..." at 12 AM -->
  <div class="card header">
    <div>
      <h1 id="dynamicTitle" class="title" style="animation:none;text-shadow:none;">Rimjhim-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶â‡¶™‡¶π‡¶æ‡¶∞</h1>
      <p id="dynamicSubtitle" class="subtitle">‡¶Ü‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶ï‡¶Ø‡¶º‡ßá‡¶ï‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§...</p>
    </div>
  </div>

  <!-- COUNTDOWN TIMER SECTION (Visible until Dec 16, 12 AM) -->
  <div id="countdownContainer" class="card" style="text-align:center;">
      <h2 style="color:var(--accent);margin-top:0">‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶ï‡ßç‡¶∑‡¶£ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ‡¶¨‡¶æ‡¶ï‡¶ø</h2>
      <div id="countdownDisplay" style="font-size:2rem;font-weight:700;color:var(--text);margin: 18px 0;">Loading Timer...</div>
      <p style="margin-bottom:0;font-size:1.1rem;font-weight:600">‡ßß‡ß¨‡¶á ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞, ‡¶†‡¶ø‡¶ï ‡¶∞‡¶æ‡¶§ ‡ßß‡ß®:‡ß¶‡ß¶ ‡¶ü‡¶æ‡ßü ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ú‡¶ø‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá‡•§</p>
  </div>
  <!-- END COUNTDOWN TIMER SECTION -->

  <!-- BIRTHDAY CONTENT (Hidden until countdown finishes) -->
  <div id="birthdayContent" style="display:none;">
    <div class="top-row">
      <div class="left card">
        <div class="hero-wrap">
          <!-- Main Hero Image (only one image) -->
          <img id="displayPhoto" class="hero" alt="Rimjhim" 
              src="https://github.com/RealShibSankarSarkar/Happy-Barthday/blob/main/Rimjhim.png?raw=true">
        </div>

        <!-- small shayari -->
        <div class="shayari" style="margin-top:18px">
          <strong style="display:block;margin-bottom:8px;color:var(--accent)">A special wish for you</strong>
          <div style="white-space:pre-wrap">
            ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ö‡ßã‡¶ñ‡ßá ‡¶∏‡ßç‡¶¨‡¶™‡ßç‡¶®, ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∏‡¶ø‡¶§‡ßá ‡¶Ü‡¶≤‡ßã ‚Äî  
            ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶π‡ßã‡¶ï ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶∂‡¶ø‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ‡•§
          </div>
        </div>

        <!-- music control visible on small area also -->
        <div style="margin-top:12px;text-align:center">
          <button id="playMusicBtn" style="background:transparent;border:1px solid rgba(0,0,0,0.08);padding:8px;border-radius:10px;cursor:pointer">
            ‚ñ∂Ô∏è Play Music
          </button>
        </div>
      </div>

      <div class="right card">
        <!-- send wish form -->
        <h3 style="margin-top:0;color:var(--accent)">Send your sweet wish</h3>

        <label for="recName">Recipient Name</label>
        <input id="recName" value="Rimjhim">

        <label for="recMsg">Your Message / Shayari</label>
        <textarea id="recMsg">üå∏ ‡¶∞‡¶ø‡¶Æ‡¶ù‡¶ø‡¶Æ ‚Äî ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∏‡¶ø ‡¶Ø‡ßá‡¶® ‡¶∏‡¶æ‡¶∞‡¶æ ‡¶¶‡¶ø‡¶® ‡¶ú‡ßã‡ßü‡¶æ‡¶∞‡ßá ‡¶≠‡¶æ‡¶∏‡ßá‡•§ Happy Birthday! üíñ</textarea>

        <div class="row">
          <div class="col" style="flex:0 0 160px">
            <label for="phone">Phone (optional)</label>
            <input id="phone" placeholder="01XXXXXXXXX">
          </div>
        </div>
        <!-- Photo URL input field removed -->

        <label for="senderName">Your Name</label>
        <input id="senderName" placeholder="Your name (optional)">

        <button id="sendBtn" class="send-btn">Send Sweet Wish! üíñ</button>

        <!-- wishes feed -->
        <h4 style="margin-top:18px;color:var(--accent);">All Wishes</h4>
        <div id="wishesGrid" class="wishes-grid"></div>
      </div>
    </div>

    <div style="text-align:center;margin-top:6px;color:gray;font-size:13px">
      Designed with ‚ù§Ô∏è by your friend Shib Sankar Sarkar
    </div>
  </div>
  <!-- END BIRTHDAY CONTENT -->

</div>

<!-- floating music control -->
<div class="music-control" id="musicControl" style="display:none">
  <button id="toggleMute" title="Pause/Play">üîà</button>
  <div style="font-size:13px;color:var(--text)">Soft Music</div>
</div>

<!-- Hidden audio -->
<audio id="bgMusic" loop muted>
  <!-- NOTE: Google Drive link used as requested. If it fails to play due to permission/format issues, replace with a direct .mp3 link. -->
  <source src="https://drive.google.com/uc?export=download&id=1FR-lJt4pwAvpXEaHsddySce1IawR323O" type="audio/mpeg">
</audio>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
/* ========================
   CONFIG - keep your own
   ======================== */
const firebaseConfig = {
  apiKey: "AIzaSyBZA9tXy6D1nyR_zyWaKiq95F5sbGjWttk",
  authDomain: "girls-b8e77.firebaseapp.com",
  projectId: "girls-b8e77",
  storageBucket: "girls-b8e77.firebasestorage.app",
  messagingSenderId: "241187517416",
  appId: "1:241187517416:web:f7547d41aa147d1e52ea5d",
  measurementId: "G-R3MMN74XW8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

/* ========================
   UI Refs
   ======================== */
const displayPhoto = document.getElementById('displayPhoto');
const sendBtn = document.getElementById('sendBtn');
const recName = document.getElementById('recName');
const recMsg = document.getElementById('recMsg');
const senderName = document.getElementById('senderName');
const phone = document.getElementById('phone');
const wishesGrid = document.getElementById('wishesGrid');

// NEW UI Refs for Countdown
const dynamicTitle = document.getElementById('dynamicTitle');
const dynamicSubtitle = document.getElementById('dynamicSubtitle');
const countdownContainer = document.getElementById('countdownContainer');
const countdownDisplay = document.getElementById('countdownDisplay');
const birthdayContent = document.getElementById('birthdayContent');

let isBigBlastActive = false; // Flag for 15-minute animation/music

/* ===============
   Countdown Timer Logic + Testing Mode
   =============== */

const currentYear = new Date().getFullYear();
// Target date: December 16th, 12:00 AM (00:00:00)
let targetDate = new Date(currentYear, 11, 16, 0, 0, 0); 
const specialEventDuration = 15 * 60 * 1000; // 15 minutes in milliseconds

// --- TESTING OVERRIDE: If URL contains ?mode=test, override the target date ---
const urlParams = new URLSearchParams(window.location.search);
if (urlParams.get('mode') === 'test') {
    // Set target date 10 seconds in the future for easy testing
    targetDate = new Date(new Date().getTime() + 10000); 
    console.log("TEST MODE ACTIVATED: Target set 10 seconds from now.");
}
// ----------------------------------------------------------------------------


function handleBirthdayStart() {
    // 1. Update the Main Header Text/Animation
    dynamicTitle.innerText = 'Happy Birthday, Rimjhim';
    dynamicTitle.style.animation = 'neon 3s infinite';
    dynamicTitle.style.textShadow = '0 0 6px rgba(255,112,166,0.8)';
    dynamicSubtitle.innerText = '‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¶‡¶ø‡¶®‡¶ü‡¶æ ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á ‡¶∞‡¶ô‡¶ø‡¶® ‚Äî ‡¶π‡¶æ‡¶∏‡¶ø, ‡¶≠‡¶æ‡¶≤‡ßã‡¶≤‡¶æ‡¶ó‡¶æ ‡¶ì ‡¶∞‡¶ø‡¶Æ‡¶ù‡¶ø‡¶Æ ‡¶Ü‡¶®‡¶®‡ßç‡¶¶‡ßá ‡¶≠‡¶∞‡¶™‡ßÅ‡¶∞‡•§';

    // 2. Hide Countdown and Show Main Content
    countdownContainer.style.display = 'none';
    birthdayContent.style.display = 'block';

    // Check for the 15-minute special event
    const now = new Date().getTime();
    const timeSinceTarget = now - targetDate.getTime();

    if (timeSinceTarget >= 0 && timeSinceTarget <= specialEventDuration) {
        // --- START 15-MINUTE SPECIAL EVENT ---
        isBigBlastActive = true;
        
        // Play Music Unmuted
        bgMusic.muted = false;
        bgMusic.play().catch(e => {
             playMusicBtn.style.display = 'inline-block';
             playMusicBtn.innerText = "üîä Play Celebration Music!";
        });
        toggleMute.innerText = 'üîä'; // Update icon to show it's unmuted

        // Trigger Big Confetti Blast and increase heart rate
        triggerBigConfetti();
        clearInterval(heartInterval);
        heartInterval = setInterval(spawnHeart, 400); // Faster hearts

        // Set a timer to revert after 15 minutes
        setTimeout(() => {
            isBigBlastActive = false;
            initializeLightConfetti();
            clearInterval(heartInterval);
            heartInterval = setInterval(spawnHeart, 800);
            
        }, specialEventDuration - timeSinceTarget); 
        // --- END 15-MINUTE SPECIAL EVENT ---

    } else {
        // If past the special time, start normally (muted play)
        bgMusic.muted = true;
        bgMusic.play().catch(e=>{
             playMusicBtn.style.display = 'inline-block';
        });
    }

    clearInterval(timerInterval); // Stop the countdown
    musicControl.style.display='flex'; // Ensure music control shows up
}


function updateCountdown() {
    const now = new Date().getTime();
    let distance = targetDate.getTime() - now;

    // Check if the target date has passed
    if (distance < 0) {
        handleBirthdayStart();
        return;
    }

    // Calculation (Days, Hours, Minutes, Seconds)
    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    // Display the result (Bengali text)
    countdownDisplay.innerHTML = `${days} ‡¶¶‡¶ø‡¶® : ${hours} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ : ${minutes} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü : ${seconds} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
}

// Run the function immediately and then every second
updateCountdown();
const timerInterval = setInterval(updateCountdown, 1000);


/* ===============
   Send wish (save to Firestore)
   ================ */
sendBtn.addEventListener('click', async ()=>{
  const r = recName.value.trim() || "Rimjhim";
  const m = recMsg.value.trim();
  if(!m){ alert("‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßã ‡¶§‡ßã!"); return; }
  const p = ""; // Photo URL is now always empty
  const s = senderName.value.trim() || "Anonymous";
  const ph = phone.value.trim();

  sendBtn.disabled = true; sendBtn.innerText = "Sending...";

  try{
    await db.collection('messages').add({
      recipient: r,
      text: m,
      photoURL: p,
      sender: s,
      phone: ph || "",
      time: firebase.firestore.FieldValue.serverTimestamp()
    });
    sendBtn.innerText = "Sent! üéâ";
    setTimeout(()=>{ sendBtn.disabled=false; sendBtn.innerText="Send Sweet Wish! üíñ" },1200);

    // reset optional fields
    senderName.value = "";
    phone.value = "";
  }catch(err){
    alert("Error: " + err.message);
    sendBtn.disabled=false;
    sendBtn.innerText="Send Sweet Wish! üíñ";
  }
});

/* ===============
   Real-time listener: show wishes as cards
   =============== */
db.collection('messages').orderBy('time','desc').onSnapshot(snap=>{
  wishesGrid.innerHTML = '';
  snap.forEach(doc=>{
    const d = doc.data();
    const when = d.time ? new Date(d.time.seconds*1000).toLocaleString('bn-BD') : '‚Äî';
    const card = document.createElement('div'); card.className='wish-card';
    card.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700;color:var(--accent)">${escapeHtml(d.sender||'Anonymous')}</div>
        <div style="font-size:12px;color:gray">${escapeHtml(when)}</div>
      </div>
      <div class="wish-meta">${escapeHtml(d.recipient||'Rimjhim')}</div>
      <div style="white-space:pre-wrap">${escapeHtml(d.text||'')}</div>
      ${d.photoURL && d.photoURL.length > 5 ? `<img class="wish-photo" src="${escapeHtml(d.photoURL)}" alt="wish photo">` : ''}
      ${d.phone ? `<div style="margin-top:8px;font-size:13px;color:gray">Phone: ${escapeHtml(d.phone)}</div>` : ''}
    `;
    wishesGrid.appendChild(card);
  });
});

/* escape to avoid XSS */
function escapeHtml(s){
  return String(s||"")
    .replace(/&/g,"&amp;")
    .replace(/</g,"&lt;")
    .replace(/>/g,"&gt;")
    .replace(/"/g,"&quot;")
    .replace(/'/g,"&#039;");
}

/* ===============
   Confetti (canvas) - light & big blast logic
   =============== */
const conf = document.getElementById('confetti');
const ctx = conf.getContext('2d');
function resizeCanvas(){ conf.width = innerWidth; conf.height = innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();
let confetti = [];

// Initial light confetti
function initializeLightConfetti(){
  confetti.length = 0;
  for(let i=0;i<120;i++){
    confetti.push({x:Math.random()*conf.width,y:Math.random()*conf.height,
      s:Math.random()*6+4, r:Math.random()*360, v:Math.random()*1.5+0.5, c:`hsl(${Math.random()*360},80%,60%)`});
  }
}
initializeLightConfetti();

function drawConfetti(){
  ctx.clearRect(0,0,conf.width,conf.height);
  confetti.forEach(p=>{
    ctx.save();
    ctx.translate(p.x,p.y);
    ctx.rotate(p.r*Math.PI/180);
    ctx.fillStyle = p.c;
    ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s*0.6);
    ctx.restore();
    p.y += p.v;
    p.r += 2;
    if(p.y > conf.height + 40){ 
        if(isBigBlastActive){
            // During blast, restart from top rapidly
            p.y = -20; p.x = Math.random()*conf.width;
        } else {
            // Normal flow, restart from random Y below visible area
            p.y = Math.random() * conf.height * -1; p.x = Math.random()*conf.width; 
        }
    }
  });
  requestAnimationFrame(drawConfetti);
}
drawConfetti();

// Big blast function called on timer end
function triggerBigConfetti() {
    confetti.length = 0; // Clear existing confetti
    // Spawn 500 pieces starting from the top
    for(let i=0;i<500;i++){ 
        confetti.push({x:Math.random()*conf.width,
                       y:Math.random()*conf.height * -1, // Start off-screen top
                       s:Math.random()*8+6, 
                       r:Math.random()*360, 
                       v:Math.random()*3+1.5, // Faster drop
                       c:`hsl(${Math.random()*360},80%,60%)`});
    }
}


/* ===============
   Floating hearts generator
   =============== */
const heartsContainer = document.getElementById('hearts');
function spawnHeart(){
  const h = document.createElement('div');
  h.className = 'heart';
  const size = Math.random()*18 + 12;
  h.style.width = h.style.height = size + 'px';
  h.style.left = Math.random()*100 + '%';
  h.style.top = (90 + Math.random()*10) + '%';
  h.style.opacity = (Math.random()*0.6 + 0.4);
  heartsContainer.appendChild(h);
  const duration = (isBigBlastActive ? 3000 : 5000) + Math.random()*5000;
  h.animate([
    {transform: `translateY(0) scale(1)`, opacity:h.style.opacity},
    {transform: `translateY(-90vh) scale(1.2)`, opacity:0}
  ], {duration:duration, easing:'linear'});
  setTimeout(()=>{ h.remove(); }, duration+100);
}
let heartInterval = setInterval(spawnHeart, 800); // Initial slower hearts

/* ===============
   Music controls
   =============== */
const bgMusic = document.getElementById('bgMusic');
const musicControl = document.getElementById('musicControl');
const toggleMute = document.getElementById('toggleMute');
const playMusicBtn = document.getElementById('playMusicBtn');

// show control if audio available
bgMusic.addEventListener('canplay', ()=>{ 
    if(birthdayContent.style.display !== 'none'){
        musicControl.style.display='flex'; 
    }
});

// Initial play attempt (muted for browser compatibility)
bgMusic.volume = 0.6;
bgMusic.muted = true;
bgMusic.play().catch(e=>{
  playMusicBtn.style.display = 'inline-block';
});

playMusicBtn.addEventListener('click', ()=>{
  bgMusic.muted = false; 
  bgMusic.play(); 
  musicControl.style.display='flex';
  playMusicBtn.style.display='none'; 
  toggleMute.innerText = 'üîä'; 
});

// toggle mute/pause
toggleMute.addEventListener('click', ()=>{
  if(bgMusic.paused){ 
    bgMusic.play(); 
    toggleMute.innerText= bgMusic.muted ? 'üîà' : 'üîä'; 
  }
  else if(bgMusic.muted){ 
    bgMusic.muted=false; 
    toggleMute.innerText='üîä'; 
  }
  else{ 
    bgMusic.muted=true; 
    toggleMute.innerText='üîà'; 
  }
});

// small UX polish: reveal music control if user interacts
window.addEventListener('click', ()=>{ 
    if(birthdayContent.style.display !== 'none'){
        musicControl.style.display='flex'; 
    }
}, {once:true});

</script>
</body>
</html>
