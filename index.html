<!doctype html>
<html lang="bn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Surprise</title>

<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* ---------- THEME ---------- */
:root{
  --bg:#fbf6f2;
  --card:#fff;
  --accent:#ff7ca8;
  --accent2:#b68bff;
  --text:#2b2b2b;
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);
  font-family:'Quicksand',sans-serif;
  color:var(--text);
  -webkit-font-smoothing:antialiased;
}

.wrap{max-width:1100px;margin:20px auto;padding:20px}

/* ---------- CARDS ---------- */
.card{
  background:var(--card);
  padding:22px;
  border-radius:18px;
  box-shadow:0 12px 30px rgba(0,0,0,0.06);
  margin-bottom:18px;
}

/* ---------- TITLE ---------- */
.title{
  font-family:'Pacifico',cursive;
  font-size:2.8rem;
  text-align:center;
  margin-bottom:10px;
  color:var(--accent);
  animation:neon 3s infinite;
}
@keyframes neon{
  0%{text-shadow:0 0 6px rgba(255,112,166,0.4)}
  50%{text-shadow:0 0 22px rgba(255,112,166,0.9)}
  100%{text-shadow:0 0 6px rgba(255,112,166,0.4)}
}

/* ---------- COUNTDOWN ---------- */
.count-big{
  font-size:1.8rem;
  font-weight:700;
  margin-top:10px;
}

/* ---------- ALBUM ---------- */
.album-title{
  text-align:center;
  font-size:1.3rem;
  color:var(--accent);
  font-weight:700;
  margin-bottom:12px;
}
.album-scroll{
  display:flex;
  gap:18px;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  padding-bottom:12px;
}
.album-scroll::-webkit-scrollbar{display:none}
.polaroid{
  flex:0 0 180px;
  height:240px;
  background:#fff;
  padding:12px;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  transform:rotate(-4deg);
  transition:0.3s;
  scroll-snap-align:center;
}
.polaroid:hover{
  transform:rotate(0) scale(1.06);
  box-shadow:0 20px 40px rgba(255,112,166,0.2);
}
.polaroid img{
  width:100%;height:100%;object-fit:cover;border-radius:10px;
}
.scroll-hint{text-align:center;color:#888;margin-top:6px;font-size:0.85rem}

/* ---------- WISHES ---------- */
.wishes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px}
.wish-card{
  background:#fff;
  padding:14px;
  border-radius:12px;
  box-shadow:0 8px 20px rgba(0,0,0,0.05);
}
label{font-weight:600;margin-top:12px;display:block}
input,textarea{
  width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;margin-top:8px;font-size:1rem;
}
textarea{min-height:90px}
.send-btn{
  width:100%;margin-top:16px;
  padding:12px;
  border:none;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#fff;font-weight:700;border-radius:12px;font-size:1rem;
}

/* ---------- HEARTS ---------- */
.hearts{
  position:fixed;left:0;top:0;right:0;bottom:0;
  pointer-events:none;
  z-index:9;
}
.heart{
  position:absolute;
  width:18px;height:18px;
  background:linear-gradient(45deg,#ff8ab8,#ffd47a);
  transform:rotate(45deg);
  border-radius:3px;
  opacity:0.9;
}
.heart:before,.heart:after{
  content:"";position:absolute;background:inherit;border-radius:50%;
}
.heart:before{width:18px;height:18px;top:-9px;left:0}
.heart:after{width:18px;height:18px;left:-9px;top:0}

/* ---------- CONFETTI ---------- */
#confetti{
  position:fixed;left:0;top:0;width:100%;height:100%;
  pointer-events:none;z-index:8;
}
</style>
</head>
<body>

<!-- AUTO-MUSIC (hidden audio) -->
<audio id="bgMusic" loop>
  <source src="https://files.catbox.moe/lnkg6v.mp3" type="audio/mpeg">
</audio>

<!-- Hearts + Confetti -->
<div id="hearts" class="hearts"></div>
<canvas id="confetti"></canvas>

<div class="wrap" id="mainWrap">

  <h1 class="title">Aesthetic Collection</h1>

  <!-- COUNTDOWN -->
  <div class="card" id="countCard">
    <h2 style="text-align:center;color:var(--accent)">‚è≥ Something special is coming</h2>
    <div id="countdownDisplay" class="count-big" style="text-align:center">Loading‚Ä¶</div>
    <p style="text-align:center;margin-top:8px;color:#777">16 ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶∞‡¶æ‡¶§ ‡ßß‡ß®:‡ß¶‡ß¶</p>
  </div>

  <!-- REVEAL HERO -->
  <div class="card" id="heroBox" style="display:none;text-align:center">
    <h2 style="font-family:'Pacifico',cursive;color:var(--accent);font-size:2.4rem">Happy Birthday, Rimjhim! üéâ</h2>
    <p style="margin-top:8px;font-weight:600">A special surprise just for you‚Ä¶</p>
  </div>

  <!-- BIRTHDAY CONTENT -->
  <div id="surpriseContent" style="display:none">

    <!-- Album -->
    <div class="card">
      <div class="album-title">‚ú® Sweet Memories ‚ú®</div>
      <div class="album-scroll" id="albumScroll">
        <div class="polaroid"><img src="https://github.com/RealShibSankarSarkar/Happy-Barthday/blob/main/cuttee.jpeg?raw=true"></div>
        <div class="polaroid"><img src="https://github.com/RealShibSankarSarkar/Happy-Barthday/blob/main/Rimjhim.png?raw=true"></div>
        <div class="polaroid"><img src="https://github.com/RealShibSankarSarkar/Happy-Barthday/blob/main/album.jpg?raw=true"></div>
        <div class="polaroid"><img src="https://github.com/RealShibSankarSarkar/Happy-Barthday/blob/main/eyes21.jpeg?raw=true"></div>
      </div>
      <p class="scroll-hint">‚¨ÖÔ∏è Scroll / Swipe ‚û°Ô∏è</p>
    </div>

    <!-- Wish Form -->
    <div class="card">
      <h3 style="color:var(--accent);margin-bottom:10px">Send a Wish üíå</h3>

      <label>Recipient</label>
      <input id="recName" value="Rimjhim">

      <label>Message</label>
      <textarea id="recMsg">üå∏ Rimjhim ‚Äî Happy Birthday! üíõ</textarea>

      <label>Your Name</label>
      <input id="senderName">

      <label>Phone (optional)</label>
      <input id="phone">

      <button class="send-btn" id="sendBtn">Send Wish üíñ</button>
    </div>

    <!-- Wish List -->
    <div class="card">
      <h3 style="color:var(--accent);margin-bottom:10px">All Wishes ‚ú®</h3>
      <div id="wishesGrid" class="wishes-grid"></div>
    </div>
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* ---------- FIREBASE CONFIG ---------- */
const firebaseConfig={
  apiKey:"AIzaSyBZA9tXy6D1nyR_zyWaKiq95F5sbGjWttk",
  authDomain:"girls-b8e77.firebaseapp.com",
  projectId:"girls-b8e77",
  storageBucket:"girls-b8e77.firebasestorage.app",
  messagingSenderId:"241187517416",
  appId:"1:241187517416:web:f7547d41aa147d1e52ea5d"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

/* ---------- AUTO MUSIC ---------- */
const music=document.getElementById("bgMusic");
music.volume=0.6;

function autoPlay(){
  music.play().then(()=>{
    document.removeEventListener("click",autoPlay);
    document.removeEventListener("touchstart",autoPlay);
    document.removeEventListener("scroll",autoPlay);
  }).catch(()=>{});
}
document.addEventListener("click",autoPlay);
document.addEventListener("touchstart",autoPlay);
document.addEventListener("scroll",autoPlay);

/* ---------- COUNTDOWN ---------- */
const cd=document.getElementById("countdownDisplay");
const url=new URL(window.location.href);
const test=url.searchParams.get("mode")==="test";

// Target: 16 Dec
let now=new Date();
let y=now.getFullYear();
let target=new Date(`${y}-12-16T00:00:00`);

if(test){
  target=new Date(Date.now()+10000);
}

let timerInterval=setInterval(updateCountdown,1000);
updateCountdown();

function updateCountdown(){
  const now=new Date();
  const diff=target-now;
  if(diff<=0){
    clearInterval(timerInterval);
    revealBirthday();
    return;
  }

  const d=Math.floor(diff/(1000*60*60*24));
  const h=Math.floor((diff%(1000*60*60*24))/(1000*60*60));
  const m=Math.floor((diff%(1000*60*60))/(1000*60));
  const s=Math.floor((diff%(1000*60))/1000);

  cd.innerText=`${pad(d)} ‡¶¶‡¶ø‡¶® : ${pad(h)} ‡¶ò‡¶®‡ßç‡¶ü‡¶æ : ${pad(m)} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü : ${pad(s)} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
}
function pad(n){return String(n).padStart(2,'0')}

/* ---------- BIRTHDAY REVEAL ---------- */
function revealBirthday(){
  // Hide countdown, show hero + content
  document.getElementById("countCard").style.display="none";
  document.getElementById("heroBox").style.display="block";
  document.getElementById("surpriseContent").style.display="block";

  // Confetti + hearts blast
  bigConfetti();
  heartInterval=setInterval(spawnHeart,400);

  // Unmute music if needed
  music.muted=false;
  music.play().catch(()=>{});
}

/* ---------- WISH FORM ---------- */
sendBtn.onclick=async()=>{
  const msg=recMsg.value.trim();
  if(!msg){alert("‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßã!");return;}

  await db.collection("messages").add({
    sender:senderName.value.trim()||"Anonymous",
    recipient:recName.value.trim()||"Rimjhim",
    text:msg,
    phone:phone.value.trim()||"",
    time:firebase.firestore.FieldValue.serverTimestamp()
  });

  recMsg.value="";
  senderName.value="";
  phone.value="";
};

/* ---------- REALTIME WISHES ---------- */
db.collection("messages").orderBy("time","desc").onSnapshot(snap=>{
  wishesGrid.innerHTML="";
  snap.forEach(doc=>{
    const d=doc.data();
    const t=d.time?d.time.toDate().toLocaleString("bn-BD"):"‚Äî";
    wishesGrid.innerHTML+=`
      <div class="wish-card">
        <div style="color:var(--accent);font-weight:700">${escape(d.sender)}</div>
        <div class="wish-meta">${escape(t)}</div>
        <div>${escape(d.text)}</div>
        ${d.phone?`<div style="margin-top:6px;font-size:13px;color:gray">üìû ${escape(d.phone)}</div>`:""}
      </div>
    `;
  });
});
function escape(s){return String(s||"").replace(/[&<>"]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[c]))}

/* ---------- CONFETTI ---------- */
const conf=document.getElementById("confetti");
const ctx=conf.getContext("2d");
function resize(){conf.width=innerWidth;conf.height=innerHeight;}
window.onresize=resize;resize();

let confetti=[];
function bigConfetti(){
  confetti=[];
  for(let i=0;i<600;i++){
    confetti.push({
      x:Math.random()*conf.width,
      y:Math.random()*-conf.height,
      s:Math.random()*8+6,
      r:Math.random()*360,
      v:Math.random()*3+1.5,
      c:`hsl(${Math.random()*360},80%,60%)`
    });
  }
}

function draw(){
  ctx.clearRect(0,0,conf.width,conf.height);
  confetti.forEach(p=>{
    ctx.save();
    ctx.translate(p.x,p.y);
    ctx.rotate(p.r*Math.PI/180);
    ctx.fillStyle=p.c;
    ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s*0.6);
    ctx.restore();
    p.y+=p.v; p.r+=2;
    if(p.y>conf.height+40){
      p.y=-20; p.x=Math.random()*conf.width;
    }
  });
  requestAnimationFrame(draw);
}
draw();

/* ---------- HEARTS ---------- */
const hearts=document.getElementById("hearts");
function spawnHeart(){
  const h=document.createElement("div");
  h.className="heart";
  const size=Math.random()*18+12;
  h.style.width=h.style.height=size+"px";
  h.style.left=Math.random()*100+"%";
  h.style.top="95%";
  hearts.appendChild(h);
  h.animate([
    {transform:"translateY(0) scale(1)",opacity:1},
    {transform:"translateY(-90vh) scale(1.3)",opacity:0}
  ],{duration:6000,easing:"linear"});
  setTimeout(()=>h.remove(),6000);
}
let heartInterval;

/* ---------- AUTO SCROLL ALBUM ---------- */
const albumScroll=document.getElementById("albumScroll");
let autoScrollPos=0,autoScrollDir=1;
setInterval(()=>{
  autoScrollPos+=autoScrollDir*1.3;
  if(autoScrollPos>albumScroll.scrollWidth-albumScroll.clientWidth-10){autoScrollDir=-1}
  if(autoScrollPos<0){autoScrollDir=1}
  albumScroll.scrollTo({left:autoScrollPos,behavior:"smooth"});
},150);
</script>
</body>
</html>
